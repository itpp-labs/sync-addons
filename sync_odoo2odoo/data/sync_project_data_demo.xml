<?xml version='1.0' encoding='UTF-8' ?>
<!-- Copyright 2021 Ilya Ilchenko <https://github.com/mentalko>
     License MIT (https://opensource.org/licenses/MIT). -->
<odoo>
    <!-- Odoo2odoo -->
    <record id="odoo2odoo_project" model="sync.project">
        <field name="name">Demo Odoo2odoo Integration #2</field>
        <field name="eval_context">odoo2odoo_demo2</field>
        <field name="active" eval="False" />
        <field name="common_code">
<![CDATA[
model_name = 'res.partner'
domain=[('name', 'ilike', 'test')]
fields=['name', 'phone', 'image_1920']
]]>
        </field>
    </record>
    <record id="odoo2odoo_project_param_url" model="sync.project.param">
        <field name="key">URL</field>
        <field name="description">
            URL to external Odoo, e.g. https://odoo.example
        </field>
        <field name="project_id" ref="sync_odoo2odoo.odoo2odoo_project" />
    </record>
    <record id="odoo2odoo_project_param_DB" model="sync.project.param">
        <field name="key">DB</field>
        <field name="description">External Odoo database name</field>
        <field name="project_id" ref="sync_odoo2odoo.odoo2odoo_project" />
    </record>
    <record id="odoo2odoo_project_secret_username" model="sync.project.secret">
        <field name="key">USERNAME</field>
        <field name="description">e.g. admin</field>
        <field name="project_id" ref="sync_odoo2odoo.odoo2odoo_project" />
    </record>
    <record id="odoo2odoo_project_secret_password" model="sync.project.secret">
        <field name="key">PASSWORD</field>
        <field name="project_id" ref="sync_odoo2odoo.odoo2odoo_project" />
    </record>
    <!-- TODO: split tasks:
         * Local Odoo to Remote Odoo
         * Remote Odoo to Local Odoo
    -->
    <record id="odoo2odoo_task_local2remote" model="sync.task">
        <field name="name">Sync Local Models To Remote Odoo</field>
        <field name="project_id" ref="sync_odoo2odoo.odoo2odoo_project" />
        <field name="code">
<![CDATA[
def handle_db(records):
    pass

def handle_button():
     if trigger == "PUSH_LOCAL_DATA":
          sync_odoo2odoo_push(model_name, domain=domain, fields=fields,  create=True, update=True)         #[('company_type', '=', 'person')]
     elif trigger == "PUSH_CREATE_ONLY":
          sync_odoo2odoo_push(model_name, domain=domain, fields=fields,  create=True, update=False)
     elif trigger == "PUSH_UPDATE_ONLY":
          sync_odoo2odoo_push(model_name, domain=domain, fields=fields,  create=False, update=True)




]]>
        </field>
    </record>
    <record id="odoo2odoo_task_remote2local" model="sync.task">
        <field name="name">Sync Remote Models Updates</field>
        <field name="project_id" ref="sync_odoo2odoo.odoo2odoo_project" />
        <field name="code">
<![CDATA[
def handle_cron():
    pass

def handle_button():
     if trigger == "PULL_LOCAL_DATA":
          sync_odoo2odoo_pull(model_name, domain=domain, fields=fields,  create=True, update=True)
     elif trigger == "PULL_CREATE_ONLY":
          sync_odoo2odoo_pull(model_name, domain=domain, fields=fields,  create=True, update=False)
     elif trigger == "PULL_UPDATE_ONLY":
          sync_odoo2odoo_pull(model_name, domain=domain, fields=fields,  create=False, update=True)
]]>
        </field>
    </record>
    <record id="odoo2odoo_trigger_automation" model="sync.trigger.automation">
        <field name="trigger_name">LOCAL_PARTNER_CREATED</field>
        <field name="sync_task_id" ref="sync_odoo2odoo.odoo2odoo_task_local2remote" />
        <field name="model_id" ref="base.model_res_partner" />
        <field name="trigger">on_create</field>
    </record>
    <record id="odoo2odoo_trigger_cron" model="sync.trigger.cron">
        <field name="trigger_name">CHECK_EXTERNAL_ODOO</field>
        <field name="sync_task_id" ref="sync_odoo2odoo.odoo2odoo_task_remote2local" />
        <field name="interval_number">15</field>
        <field name="interval_type">minutes</field>
    </record>
    <record id="odoo2odoo_trigger_button" model="sync.trigger.button">
        <field name="trigger_name">PUSH_LOCAL_DATA</field>
        <field name="sync_task_id" ref="sync_odoo2odoo.odoo2odoo_task_local2remote" />
    </record>
    <record id="odoo2odoo_trigger_button2" model="sync.trigger.button">
        <field name="trigger_name">PULL_EXTERNAL_DATA</field>
        <field name="sync_task_id" ref="sync_odoo2odoo.odoo2odoo_task_remote2local" />
    </record>
    <record id="odoo2odoo_trigger_button3" model="sync.trigger.button">
        <field name="trigger_name">PUSH_UPDATE_ONLY</field>
        <field name="sync_task_id" ref="sync_odoo2odoo.odoo2odoo_task_local2remote" />
    </record>
    <record id="odoo2odoo_trigger_button4" model="sync.trigger.button">
        <field name="trigger_name">PUSH_CREATE_ONLY</field>
        <field name="sync_task_id" ref="sync_odoo2odoo.odoo2odoo_task_local2remote" />
    </record>
    <record id="odoo2odoo_trigger_button5" model="sync.trigger.button">
        <field name="trigger_name">PULL_UPDATE_ONLY</field>
        <field name="sync_task_id" ref="sync_odoo2odoo.odoo2odoo_task_remote2local" />
    </record>
    <record id="odoo2odoo_trigger_button6" model="sync.trigger.button">
        <field name="trigger_name">PULL_CREATE_ONLY</field>
        <field name="sync_task_id" ref="sync_odoo2odoo.odoo2odoo_task_remote2local" />
    </record>
</odoo>
